<ion-content>

  <!-- ======================= -->
  <!-- HEADER CUSTOM SUPERIOR  -->
  <!-- ======================= -->
  <div class="registro-topbar">

    <!-- Botón Back -->
    <button
      type="button"
      class="topbar-back"
      (click)="goBack()"
    >
      <span class="back-arrow">←</span>
      <span class="back-text">{{ 'REGISTER.BACK' | translate }}</span>
    </button>

    <!-- Título centrado -->
    <div class="topbar-title">
      {{ 'REGISTER.TITLE' | translate }}
    </div>

    <!-- Espaciador derecho -->
    <div class="topbar-spacer"></div>
  </div>

  <!-- ======================= -->
  <!-- CONTENIDO CENTRADO      -->
  <!-- ======================= -->
  <div class="registro-wrapper">
    <div class="registro-inner">

      <h2 class="registro-title">
        {{ 'REGISTER.CREATE_ACCOUNT' | translate }}
      </h2>

      <p class="registro-subtitle">
        {{ 'REGISTER.SUBTITLE' | translate }}
      </p>

      <form novalidate class="registro-card">

        <!-- Nombres -->
        <div class="campo">
          <label>{{ 'REGISTER.NAME' | translate }}</label>
          <input type="text" [(ngModel)]="nombre" name="nombre" required />
        </div>
        <ion-text color="danger" *ngIf="submitted && !nombre">
          <p class="error-text">{{ 'REGISTER.ERROR_NAME_REQUIRED' | translate }}</p>
        </ion-text>

        <!-- Apellidos -->
        <div class="campo">
          <label>{{ 'REGISTER.LASTNAME' | translate }}</label>
          <input type="text" [(ngModel)]="apellidos" name="apellidos" required />
        </div>
        <ion-text color="danger" *ngIf="submitted && !apellidos">
          <p class="error-text">{{ 'REGISTER.ERROR_LASTNAME_REQUIRED' | translate }}</p>
        </ion-text>

        <!-- RUT -->
        <div class="campo">
          <label>{{ 'REGISTER.RUT' | translate }}</label>
          <input type="text" [(ngModel)]="rut" name="rut" required />
        </div>
        <ion-text color="danger" *ngIf="submitted && !esRutValido(rut)">
          <p class="error-text">{{ 'REGISTER.ERROR_RUT_INVALID' | translate }}</p>
        </ion-text>

        <!-- Teléfono -->
        <div class="campo">
          <label>{{ 'REGISTER.PHONE' | translate }}</label>
          <input type="tel" [(ngModel)]="telefono" name="telefono" required />
        </div>
        <ion-text color="danger" *ngIf="submitted && !esTelefonoValido(telefono)">
          <p class="error-text">{{ 'REGISTER.ERROR_PHONE_INVALID' | translate }}</p>
        </ion-text>

        <!-- Correo -->
        <div class="campo">
          <label>{{ 'REGISTER.EMAIL' | translate }}</label>
          <input type="email" [(ngModel)]="correo" name="correo" required />
        </div>
        <ion-text color="danger" *ngIf="submitted && !esCorreoBasicoValido(correo)">
          <p class="error-text">{{ 'REGISTER.ERROR_EMAIL_INVALID' | translate }}</p>
        </ion-text>

        <!-- Contraseña -->
        <div class="campo">
          <label>{{ 'REGISTER.PASSWORD' | translate }}</label>
          <input type="password" [(ngModel)]="clave" name="clave" required />
        </div>

        <!-- Confirmar contraseña -->
        <div class="campo">
          <label>{{ 'REGISTER.CONFIRM_PASSWORD' | translate }}</label>
          <input type="password" [(ngModel)]="confirmarClave" name="confirmarClave" required />
        </div>

        <!-- Error si no coinciden -->
        <ion-text color="danger" *ngIf="submitted && clave !== confirmarClave">
          <p class="error-text">{{ 'REGISTER.ERROR_PASSWORD_MATCH' | translate }}</p>
        </ion-text>

        <!-- BOTÓN REGISTRARSE -->
        <ion-button expand="block" type="button" class="btn-registrar" (click)="registrarUsuario()">
          {{ 'REGISTER.BUTTON' | translate }}
        </ion-button>

        <!-- ⚠️ MENSAJE GLOBAL DE REGISTRO (ÉXITO/ERROR) -->
        <ion-text *ngIf="mensajeRegistro">
          <p
            class="mensaje-global"
            [ngClass]="tipoMensajeRegistro === 'ok' ? 'mensaje-exito' : 'mensaje-error'">
            {{ mensajeRegistro }}
          </p>
        </ion-text>

      </form>

    </div>
  </div>

</ion-content>
