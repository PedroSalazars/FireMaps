<!-- ============================
     üîù TOPBAR ‚Äì ESTILO FIREMAPS PRO
============================ -->
<ion-header>
  <ion-toolbar class="header-toolbar">
    <ion-title class="header-title">FireMaps Chilo√©</ion-title>
  </ion-toolbar>
</ion-header>

<!-- ============================
     üó∫Ô∏è CONTENIDO PRINCIPAL
============================ -->
<ion-content fullscreen="true">

  <div class="notif-wrapper">
    <div class="notif-inner">

      <!-- MAPA -->
      <div class="map-container">
        <div id="map" class="map-box"></div>

        <!-- FAB Reportar -->
        <ion-fab
          class="report-fab"
          slot="fixed"
          vertical="bottom"
          horizontal="end">
          <div class="fab-circle-wrapper">
            <ion-fab-button aria-label="Reportar" class="fab-btn" (click)="openReportModal()">
              <span class="fab-plus">+</span>
            </ion-fab-button>
          </div>
        </ion-fab>
      </div>

    </div>
  </div>

  <!-- ============================
       üìÑ MODAL ‚Äì REPORTAR INCIDENTE
  ============================ -->
  <ion-modal [isOpen]="reportOpen" (didDismiss)="closeReportModal()" class="report-modal">
    <ng-template>

      <ion-header class="modal-header">
        <ion-toolbar class="modal-toolbar">
          <ion-title class="modal-title">Reportar problema</ion-title>
          <ion-buttons slot="end">
            <ion-button class="modal-close-btn" (click)="closeReportModal()">Cerrar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="modal-content ion-padding">

        <!-- Ubicaci√≥n -->
        <div class="field">
          <div class="field-label"><strong>Ubicaci√≥n</strong></div>
          <div class="hint">Ingresa la direcci√≥n del incidente. Las b√∫squedas est√°n limitadas a Chilo√©, Chile.</div>
        </div>

        <!-- Tipo de incidente -->
        <div class="field">
          <div class="field-label"><strong>Tipo</strong></div>
          <div class="types">
            <button class="type-btn" [class.sel]="reportType === 'Incendio'" (click)="setReportType('Incendio')">Incendio</button>
            <button class="type-btn" [class.sel]="reportType === 'FuGas'" (click)="setReportType('FuGas')">FuGas</button>
            <button class="type-btn" [class.sel]="reportType === 'rescate'" (click)="setReportType('rescate')">Rescate</button>
            <button class="type-btn" [class.sel]="reportType === 'choque'" (click)="setReportType('choque')">Choque</button>
          </div>

          <div class="hint">La prioridad se ajusta autom√°ticamente seg√∫n el tipo.</div>
          <div class="error" *ngIf="formErrors.type">{{ formErrors.type }}</div>
        </div>

        <!-- Direcci√≥n -->
        <div class="field">
          <div class="field-label"><strong>Direcci√≥n</strong></div>
          <input id="report-address-input"
                 class="input-text"
                 type="text"
                 placeholder="Ej: Avenida Galvarino Riveros, Castro"
                 [(ngModel)]="reportAddress"/>

          <div class="hint">Escribe y selecciona una opci√≥n de la lista.</div>
          <div class="error" *ngIf="formErrors.address">{{ formErrors.address }}</div>
        </div>

        <!-- Descripci√≥n -->
        <div class="field">
          <div class="field-label"><strong>Descripci√≥n breve</strong> (opcional)</div>

          <ion-textarea
            class="input-textarea"
            fill="outline"
            [rows]="3"
            maxlength="200"
            placeholder="Ej: Humo denso saliendo de vivienda"
            [(ngModel)]="reportNotes">
          </ion-textarea>

          <div class="error" *ngIf="formErrors.notes">{{ formErrors.notes }}</div>
        </div>

        <ion-button expand="block"
                    class="submit-btn"
                    [disabled]="!canSubmitReport()"
                    (click)="submitReport()">
          Enviar reporte
        </ion-button>

      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>

<!-- ============================
     üü† FOOTER ‚Äì BOTTOM NAV MINI PREMIUM
============================ -->
<div class="bottom-nav-shell">
  <div class="bottom-nav-mini">

    <ion-button fill="clear"
                class="bottom-nav-mini-item bottom-nav-mini-item--active"
                [routerLink]="['/vista-home']">
      {{ 'FOOTER.HOME' | translate }}
    </ion-button>

    <ion-button fill="clear"
                class="bottom-nav-mini-item"
                [routerLink]="['/vista-perfil-usuario']">
      {{ 'FOOTER.SETTINGS' | translate }}
    </ion-button>

    <ion-button fill="clear"
                class="bottom-nav-mini-item"
                [routerLink]="['/vista-login']">
      {{ 'FOOTER.LOGOUT' | translate }}
    </ion-button>

  </div>
</div>
